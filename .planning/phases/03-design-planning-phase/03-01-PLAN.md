---
phase: 03-design-planning-phase
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/stacks-dev/references/clarity-design.md
autonomous: true

must_haves:
  truths:
    - "User can create pseudo code before implementation (DSGN-01)"
    - "Skill reviews designs against Clarity Book best practices (DSGN-02)"
    - "Skill recommends modular architecture for upgradability (DSGN-03)"
    - "Skill links to authoritative sources not embedded docs (DSGN-04)"
    - "Design artifacts saved to project directory"
  artifacts:
    - path: "skills/stacks-dev/references/clarity-design.md"
      provides: "Enhanced design phase reference with template, checklist, modular architecture"
      contains: "Design Document Template"
    - path: "skills/stacks-dev/references/clarity-design.md"
      provides: "Best practices checklist linked to Clarity Book Ch13"
      contains: "Best Practices Checklist"
    - path: "skills/stacks-dev/references/clarity-design.md"
      provides: "Modular architecture guidance with ExecutorDAO pattern"
      contains: "Modular Architecture"
  key_links:
    - from: "skills/stacks-dev/SKILL.md"
      to: "references/clarity-design.md"
      via: "Phase 1 Design reference link"
      pattern: "references/clarity-design.md"
    - from: "skills/stacks-dev/references/clarity-design.md"
      to: "Clarity Book Ch13"
      via: "External documentation links"
      pattern: "book.clarity-lang.org"
---

<objective>
Enhance the clarity-design.md reference file to provide comprehensive design phase guidance including pseudo code templates, Clarity Book best practices, and modular architecture patterns.

Purpose: Enable developers to design high-quality Clarity contracts before implementation through structured design documents, pseudo code, and best practices review.

Output: Enhanced clarity-design.md reference file (~200 lines) with design document template, best practices checklist, and modular architecture guidance.
</objective>

<execution_context>
@/Users/kenny/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kenny/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-design-planning-phase/03-RESEARCH.md

# Existing artifact to enhance
@skills/stacks-dev/references/clarity-design.md

# SKILL.md for context on how reference is used
@skills/stacks-dev/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance clarity-design.md with design document template and best practices</name>
  <files>skills/stacks-dev/references/clarity-design.md</files>
  <action>
Rewrite clarity-design.md to include comprehensive design phase guidance. Target ~200 lines (under limit) with the following structure:

1. **Design Document Template** (~60 lines)
   - Purpose and requirements section
   - Data structures section (constants, data-vars, maps)
   - Public interface section (functions, error codes)
   - Pseudo code section with Clarity-like syntax
   - Best practices checklist section

2. **Best Practices Checklist** (~40 lines)
   From Clarity Book Ch13, organized as actionable checklist:
   - Coding style: No unnecessary begin, use asserts!, meaningful errors
   - Storage: Hash on-chain, data off-chain; use at-block for history
   - Upgradability: Modular architecture, dynamic principals

3. **Modular Architecture** (~40 lines)
   Based on ExecutorDAO pattern:
   - Core + Extensions separation concept
   - When to use modular vs monolithic
   - Dynamic principals pattern (use data-var not constants)

4. **External References** (~30 lines)
   Links (not content) to authoritative sources:
   - Clarity Book Ch13-01, Ch13-02, Ch13-03 URLs
   - Stacks documentation URLs
   - SIP standards (SIP-009, SIP-010)
   - ExecutorDAO GitHub reference

**Key constraints:**
- Link to sources, don't duplicate content (DSGN-04)
- Provide pseudo code template users can fill in (DSGN-01)
- Include actionable checklist for best practices (DSGN-02)
- Document modular architecture for upgradability (DSGN-03)
- Stay under 200 lines total

**Remove from existing file:**
- Detailed code examples (keep minimal, link to Clarity Book instead)
- Redundant content that's covered better in linked sources
  </action>
  <verify>
1. File exists: `ls skills/stacks-dev/references/clarity-design.md`
2. Line count under 200: `wc -l skills/stacks-dev/references/clarity-design.md`
3. Contains design template: `grep -c "Design Document Template\|## Template" skills/stacks-dev/references/clarity-design.md` returns > 0
4. Contains best practices checklist: `grep -c "Best Practices Checklist" skills/stacks-dev/references/clarity-design.md` returns > 0
5. Contains modular architecture: `grep -c "Modular Architecture\|ExecutorDAO" skills/stacks-dev/references/clarity-design.md` returns > 0
6. Contains Clarity Book links: `grep -c "book.clarity-lang.org" skills/stacks-dev/references/clarity-design.md` returns > 0
7. skills-ref validate passes: `npx skills-ref validate ./skills/stacks-dev`
  </verify>
  <done>
clarity-design.md enhanced with:
- Design document template with pseudo code structure
- Best practices checklist from Clarity Book Ch13
- Modular architecture guidance with ExecutorDAO pattern
- Links to authoritative sources (Clarity Book, Stacks docs, SIPs)
- Under 200 lines total
  </done>
</task>

</tasks>

<verification>
After task completion, verify Phase 3 requirements are satisfied:

1. **DSGN-01 (Pseudo code guidance):**
   - Design template includes pseudo code section
   - Users can write pseudo code before implementation

2. **DSGN-02 (Best practices review):**
   - Checklist covers Clarity Book Ch13 best practices
   - Coding style, storage, and upgradability patterns included

3. **DSGN-03 (Modular architecture):**
   - ExecutorDAO pattern documented
   - Dynamic principals pattern explained
   - Guidance on when to use modular vs monolithic

4. **DSGN-04 (Authoritative source links):**
   - Links to Clarity Book chapters (not duplicated content)
   - Links to Stacks documentation
   - Links to SIP standards
</verification>

<success_criteria>
1. clarity-design.md exists and is under 200 lines
2. File contains design document template with pseudo code section
3. File contains best practices checklist referencing Clarity Book Ch13
4. File contains modular architecture section mentioning ExecutorDAO pattern
5. File contains external links to book.clarity-lang.org, docs.stacks.co, and SIP standards
6. `npx skills-ref validate ./skills/stacks-dev` passes
</success_criteria>

<output>
After completion, create `.planning/phases/03-design-planning-phase/03-01-SUMMARY.md`
</output>
