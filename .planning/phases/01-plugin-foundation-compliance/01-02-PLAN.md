---
phase: 01-plugin-foundation-compliance
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified: []
autonomous: true

must_haves:
  truths:
    - "skills-ref validate passes with no errors"
    - "Plugin installs successfully via claude plugins add"
    - "Skill appears in /help menu after installation"
    - "Skill auto-loads when user mentions Stacks or Clarity"
  artifacts:
    - path: "skills/stacks-dev/SKILL.md"
      provides: "Validated skill file"
      validation: "skills-ref validate passes"
  key_links:
    - from: "claude plugins add"
      to: "plugin directory"
      via: "local path installation"
      pattern: "claude plugins add /path/to/stacks-skills"
    - from: "skill description"
      to: "auto-activation"
      via: "keyword matching"
      pattern: "Stacks|Clarity|Clarinet"
---

<objective>
Validate the plugin structure using skills-ref and install the plugin locally to verify it works correctly in Claude Code.

Purpose: Ensure the plugin passes all Agent Skills spec validation checks and is fully functional when installed, completing the Phase 1 compliance requirements.

Output: Validated, installed plugin that appears in /help and auto-activates on relevant keywords.
</objective>

<execution_context>
@/Users/kenny/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kenny/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-plugin-foundation-compliance/01-RESEARCH.md
@.planning/phases/01-plugin-foundation-compliance/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install skills-ref validator</name>
  <files></files>
  <action>
Check if skills-ref is installed, and install it if not.

```bash
# Check if installed
pip show skills-ref || uv tool install skills-ref

# Verify installation
skills-ref --version
```

If pip is not available, try:
- `uv tool install skills-ref`
- `pipx install skills-ref`

Ensure the skills-ref command is available in PATH.
  </action>
  <verify>
Run: `skills-ref --help`
Must show usage information without errors.
  </verify>
  <done>
skills-ref validator is installed and accessible via command line.
  </done>
</task>

<task type="auto">
  <name>Task 2: Validate skill with skills-ref</name>
  <files></files>
  <action>
Run the skills-ref validator against the stacks-dev skill directory.

```bash
cd /Users/kenny/Code/stacks-skills
skills-ref validate ./skills/stacks-dev
```

If validation fails, the error output will indicate:
- Missing required fields in frontmatter
- Name field format violations (not lowercase+hyphens, exceeds 64 chars, doesn't match directory)
- Description field too long (over 1024 chars)
- Invalid YAML syntax

If ANY validation errors occur:
1. Read the error message carefully
2. Fix the issue in SKILL.md
3. Re-run validation until it passes

Also run read-properties to see parsed skill metadata:
```bash
skills-ref read-properties ./skills/stacks-dev
```
  </action>
  <verify>
Run: `skills-ref validate ./skills/stacks-dev`
Must output validation success with no errors.
  </verify>
  <done>
skills-ref validate passes with no errors, confirming SPEC-01 through SPEC-07 compliance.
  </done>
</task>

<task type="auto">
  <name>Task 3: Test plugin installation and activation</name>
  <files></files>
  <action>
Test the plugin installation locally using claude CLI.

1. First, verify plugin.json is valid:
```bash
cd /Users/kenny/Code/stacks-skills
jq . .claude-plugin/plugin.json
```

2. Test plugin loading with debug output (informational only - may show warnings for new session):
```bash
claude --print "test" --plugin-dir /Users/kenny/Code/stacks-skills 2>&1 | head -20
```

3. Document the plugin path for installation:
The plugin can be installed via:
- Local path: `claude plugins add /Users/kenny/Code/stacks-skills`
- After git push: `claude plugins add https://github.com/username/stacks-skills`

Note: Full interactive testing (skill appearing in /help, auto-activation on "Stacks" keyword) requires a manual Claude Code session. This task verifies the plugin structure is correct for installation.

4. Create a test script for manual verification:
```bash
echo "# Manual Verification Steps
1. Open new Claude Code session
2. Run: claude --plugin-dir /Users/kenny/Code/stacks-skills
3. Type /help - should show stacks-skills:stacks-dev
4. Type 'I want to build a Clarity contract' - skill should auto-load
5. Type /stacks-skills:stacks-dev - skill should invoke directly" > /Users/kenny/Code/stacks-skills/TESTING.md
```
  </action>
  <verify>
1. jq validates plugin.json syntax
2. claude --plugin-dir command executes without fatal errors
3. TESTING.md created with manual verification steps
  </verify>
  <done>
Plugin structure verified for installation. TESTING.md provides manual verification steps for interactive testing.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Validator check:
```bash
skills-ref validate ./skills/stacks-dev
```
Must pass with no errors.

2. Properties check:
```bash
skills-ref read-properties ./skills/stacks-dev
```
Must show parsed skill properties with all required fields.

3. Plugin.json syntax:
```bash
jq . .claude-plugin/plugin.json
```
Must be valid JSON.

4. Complete structure verification:
```bash
echo "=== Plugin Structure ===" && \
find /Users/kenny/Code/stacks-skills -type f \( -name "*.json" -o -name "*.md" -o -name ".gitkeep" \) | grep -v ".git/" | grep -v ".planning/" | sort && \
echo "" && \
echo "=== Validation ===" && \
skills-ref validate ./skills/stacks-dev
```
</verification>

<success_criteria>
- skills-ref validate passes with no errors (SPEC-06 complete)
- skills-ref read-properties shows all required fields
- plugin.json is valid JSON (PLUG-01 complete)
- Plugin structure follows Claude Code requirements (PLUG-02 complete)
- TESTING.md provides manual verification steps (PLUG-03 verification path documented)
- All Phase 1 requirements (PLUG-01, PLUG-02, PLUG-03, SPEC-01 through SPEC-08) are satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/01-plugin-foundation-compliance/01-02-SUMMARY.md`
</output>
